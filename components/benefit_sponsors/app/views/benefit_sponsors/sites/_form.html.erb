<%= form_for @site, as: :site, url: { action: 'create' }, html: { data: { controller: "site" }, class: "needs-validation", id:'broker_registration_form', novalidate:true } do |f| %>
  <div class="form-group">
    <label for="inputSiteKey">Site Key</label>
    <%= f.text_field :site_key, required:'true', id:'inputSiteKey', class:'form-control'%>
    <label for="inputLongName">Long Name</label>
    <%= f.text_field :long_name, id:'inputLongName', class:'form-control'%>
    <label for="inputShortName">Short Name</label>
    <%= f.text_field :short_name, id:'inputShortName', class:'form-control'%>
    <label for="inputByLine">By Line</label>
    <%= f.text_field :byline, id:'inputShByLine', class:'form-control'%>
  </div>

  <%= f.fields_for :owner_organization, @site.owner_organization || BenefitSponsors::Organizations::ExemptOrganization.new do |organization_fields| %>
    <div class="form-group">
      <label for="inputLegalName">Organization Legal Name</label>
      <%= organization_fields.text_field :legal_name, id: 'inputLegalName', class: 'form-control' %>
    </div>

    <%= organization_fields.fields_for :office_locations, organization_fields.object.primary_office_location || organization_fields.object.office_locations.build do |office_fields| %>
      <%= office_fields.hidden_field :is_primary, value: true %>

      <!-- <%= office_fields.fields_for :phone, office_fields.object.phone || BenefitSponsors::Locations::Phone.new do |phone_fields| %>
        <%= phone_fields.hidden_field :kind, value: 'main' %>

        <label for="inputPhoneAreaCode">Phone</label>
        <%= phone_fields.text_field :area_code, id: 'inputAreaCode', class: 'form-control' %>
        <%= phone_fields.text_field :number, id: 'inputPhoneNumber', class: 'form-control' %>
      <% end %> -->

      <div data-target="site.officeLocations">
        <%= office_fields.fields_for :address, office_fields.object.address || BenefitSponsors::Locations::Address.new do |address_fields| %>
          <%= address_fields.hidden_field :kind, value: 'primary' %>

          <%= render partial: 'benefit_sponsors/locations/address', locals: { f: address_fields } %>
        <% end %>
      </div>

      <a class="btn btn-sm btn-outline-primary" data-action="click->site#addLocation">Add another location</a>
    <% end %>
  <% end %>

  <%= link_to 'Back', sites_path, class:'btn btn-default' %><%= f.submit class:'btn btn-primary' %>
<% end %>
