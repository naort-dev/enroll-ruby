// This is a manifest file that'll be compiled into application.js, which will include all the files
// listed below.
//
// Any JavaScript/Coffee file within this directory, lib/assets/javascripts, vendor/assets/javascripts,
// or any plugin's vendor/assets/javascripts directory can be referenced here using a relative path.
//
// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the
// compiled file.
//
// Read Sprockets README (https://github.com/rails/sprockets#sprockets-directives) for details
// about supported directives.
//
//= require jquery
//= require jquery.turbolinks
//= require jquery-ui
//= require jquery_ujs
//= require jquery.mask
//= require bootstrap.min
//= require bootstrap-multiselect
//= require_tree .

var disableSelectric = false;

$(document).on('ready page:load', function () {
  Freebies.fadeElement($("body"));
  Freebies.allFreebies();
  Responsive.setSizeListeners();
});

function applyMultiLanguageSelect() {
  $('#broker_agency_language_select').multiselect({
    nonSelectedText: 'Select Language',
    maxHeight: 300
  });
  $('#broker_agency_language_select').multiselect('select', 'en', true);
  $('#broker_agency_language_select').on('selectric-init', function(element){
    $('.language_multi_select .selectric-interaction-field-control-broker-agency-languages-spoken').hide();
  });
};

function applyMultiLanguageSelectForGA() {
  $('#general_agency_language_select').multiselect({
    nonSelectedText: 'Select Language',
    maxHeight: 300
  });
  $('#general_agency_language_select').multiselect('select', 'en', true);
  $('#general_agency_language_select').on('selectric-init', function(element){
    $('.language_multi_select .selectric-interaction-field-control-general-agency-languages-spoken').hide();
  });
};

function dchbx_enroll_date_of_record() {
  return new Date($('#dchbx_enroll_date_of_record').text());
};


$(document).ready(function () {

  // ACTUALLY BELONGS IN APPLICATION.JS
  $('.module a.view-more').on('click', function() {
    event.preventDefault();
    if ( $(this).hasClass('view-less') ) {
      $(this).html('View More<i class="fa fa-chevron-down"></i>');
      $(this).removeClass('view-less');
      $(this).closest('.section').find('.dn').slideUp();
    } else {
      $(this).html('View Less<i class="fa fa-chevron-up"></i>');
      $(this).addClass('view-less');
      if ( $(this).closest('.module').hasClass('employer-welcome') ) {
        $(this).closest('.section').find('.dn').slideDown();
      }
    }
  });

  semantic_class(); //Calls semantic class on all input fields & buttons (eg. interaction-click-control-continue)

  $(document).on("focus", "[class~='date-picker']", function(e){
    dateMin = $(this).attr("data-date-min");
    dateMax = $(this).attr("data-date-max");

    if ($(this).hasClass('dob-picker') || $(this).hasClass('hire-picker')){
      $(this).datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: 'mm/dd/yy',
        maxDate: "+0d",
        yearRange: dchbx_enroll_date_of_record().getFullYear()-110 + ":" + dchbx_enroll_date_of_record().getFullYear(),
        onSelect: function(dateText, dpInstance) {
          $(this).datepicker("hide");
          $(this).trigger('change');
        }
      });
    }else{
      $(this).datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: 'mm/dd/yy',
        minDate: dateMin,
        maxDate: dateMax,
        yearRange: dchbx_enroll_date_of_record().getFullYear()-110 + ":" + (dchbx_enroll_date_of_record().getFullYear() + 10),
        onSelect: function(dateText, dpInstance) {
          $(this).datepicker("hide");
          $(this).trigger('change');
        }
      });
    }
  });

  $(".address-li").on('click',function(){
    $(".address-span").html($(this).data("address-text"));
    $(".address-row").hide();
    divtoshow = $(this).data("value") + "-div";
    $("."+divtoshow).show();
  });
  // Add something similar to jqueries deprecated .toggle()
  $.fn.toggleClick=function(){
    var functions=arguments, iteration=0
    return this.click(function(){
      functions[iteration].apply(this,arguments)
      iteration= (iteration+1) %functions.length
    })
  }

  // Input Masks
  $(".phone_number").mask("(999) 999-9999");
  $(".zip").mask("99999");
  $("#person_ssn").mask("999-99-9999");
  $(".fien_field").mask("99-9999999");
  $(".person_ssn").mask("999999999");
  $(".npn_field").mask("9999999999");
  $(".address-state").mask("AA");
  $(".mask-ssn").mask("999-99-9999");
  $("#jq_datepicker_ignore_census_employee_dob, #jq_datepicker_ignore_person_dob, #family_member_dob_, #jq_datepicker_ignore_organization_dob, [name='jq_datepicker_ignore_dependent[dob]'], .date-field").mask("99/99/9999");
  $(".area_code").mask("999");
  $(".phone_number7").mask("999-9999");
  $("#tribal_id").mask("999999999");
  $(".mask-csl").mask("9999999999");

  $(document).on('focusout', "#person_ssn, .mask-ssn", function(){
    var ssn_val = $(this).val();
    ssn_patt1=/^000/;
    ssn_patt2=/^666/;
    ssn_patt3=/^....00/;
    ssn_patt4=/000$/;
  });

  $(document).on('click', '.return_to_broker_applicants', function() {
    $('#edit_broker_applicant').html('');
    $('#broker_applicants_roster').show();
  });
  $("#contact > #address_info > div, #contact > #phone_info > div, #contact > #email_info > .email > div").click(function(){
    $("#contact > #address_info > div, #contact > #phone_info > div, #contact > #email_info > .email > div").addClass('focus_none');
    $("#contact > #address_info > div, #contact > #phone_info > div, #contact > #email_info > .email > div").removeClass('add_focus');
    $(this).removeClass('focus_none');
    $(this).addClass('add_focus');
  });

  $('.member_address_links').click(function(){
    var member_id = $(this).data('id');
    $.ajax({
      url: '/people/'+member_id+'/get_member',
      type: 'GET',
      success: function(response){
        $('#member_address_area').html(response);
      }
    });
    $('#dLabel').html($(this).text()+"<i class='glyphicon glyphicon-menu-down'></i>");
  });
});


Freebies.popover();

$(document).on('click', '#address_info + span.form-action', function(){
  if ($(this).text() == "Add Mailing Address"){
    $(this).text('Remove Mailing Address');
    $('.row-form-wrapper.mailing-div').show();
  }else if ($(this).text() == "Remove Mailing Address"){
    $(this).text('Add Mailing Address');
    $('.mailing-div').hide();
    $(".mailing-div input[type='text']").val("");
    $('.mailing-div .label-floatlabel').hide();
  }
});

